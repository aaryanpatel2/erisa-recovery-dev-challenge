{% load static %}
<!-- Tailwind CSS configurations will not let some components get styled so manual styling done here -->
<style>
[x-cloak] { display: none !important; }
.denial_reason {
  color: #e3342f; /* Tailwind's red-600 */
}
.button-with-icon {
    background-color: rgb(230, 227, 227);
    padding: 0.5rem 0.75rem; /* Tailwind's p-2 */
    display: flex; 
    align-items: center;
    gap: 0.25rem; 
    border-radius: 0.375rem; /* Tailwind's rounded-md */
}
.actions {
  padding-top: 0.5rem;
  padding-bottom: 0.5rem;
  padding-left: 1rem;
  padding-right: 1rem;
  display: flex;
  flex-direction: row;
  gap: 0.5rem;
  align-items: center;
  justify-content: center;
}
</style>
<div class="overflow-x-auto" style="max-height: 500px;">
  <table class="min-w-full divide-y divide-gray-200 rounded-lg bg-white">
    <thead class="bg-blue-500 text-white">
      <tr>
        <th class="px-4 py-2 text-center">Claim ID</th>
        <th class="px-4 py-2 text-center">Patient Name</th>
        <th class="px-4 py-2 text-center">Billed</th>
        <th class="px-4 py-2 text-center">Paid</th>
        <th class="px-4 py-2 text-center">Status</th>
        <th class="px-4 py-2 text-center">Insurer</th>
        <th class="px-4 py-2 text-center">Discharge Date</th>
    <th class="px-4 py-2 text-center w-40">Actions</th>
      </tr>
    </thead>
    <tbody x-data="{ expandedRows: [] }" class="divide-y divide-gray-100">
      {% for claim in claims %}
        <tr class="hover:bg-blue-50">
          <td class="px-4 py-2 text-center">{{ claim.id }}</td>
          <td class="px-4 py-2 text-center">{{ claim.patient_name }}</td>
          <td class="px-4 py-2 text-center">{{ claim.billed_amount }}</td>
          <td class="px-4 py-2 text-center">{{ claim.paid_amount }}</td>
          <td class="px-4 py-2 text-center">{{ claim.status }}</td>
          <td class="px-4 py-2 text-center">{{ claim.insurer_name }}</td>
          <td class="px-4 py-2 text-center">{{ claim.discharge_date }}</td>
           <td class="actions">
            <button @click="expandedRows.includes({{ claim.id }}) ? expandedRows.splice(expandedRows.indexOf({{ claim.id }}), 1) : expandedRows.push({{ claim.id }})" class="button-with-icon">
              View
              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" class="bi bi-eye-fill align-middle" style="padding: top 2px;" viewBox="0 0 16 16">
                <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0"/>
                <path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8m8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7"/>
              </svg>
            </button>
            <button title="Flag" class="inline-flex items-center p-2 rounded hover:bg-red-100 text-red-600 focus:outline-none focus:ring-2 focus:ring-red-400">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 640 640"><path d="M144 88C144 74.7 133.3 64 120 64C106.7 64 96 74.7 96 88L96 552C96 565.3 106.7 576 120 576C133.3 576 144 565.3 144 552L144 452L224.3 431.9C265.4 421.6 308.9 426.4 346.8 445.3C391 467.4 442.3 470.1 488.5 452.7L523.2 439.7C535.7 435 544 423.1 544 409.7L544 130C544 107 519.8 92 499.2 102.3L489.6 107.1C443.3 130.3 388.8 130.3 342.5 107.1C307.4 89.5 267.1 85.1 229 94.6L144 116L144 88zM144 165.5L240.6 141.3C267.6 134.6 296.1 137.7 321 150.1C375.9 177.5 439.7 179.8 496 156.9L496 398.7L471.6 407.8C437.9 420.4 400.4 418.5 368.2 402.4C320 378.3 264.9 372.3 212.6 385.3L144 402.5L144 165.5z"/></svg>
            </button>
          </td>
        </tr>
        <tr x-show="expandedRows.includes({{ claim.id }})" x-cloak class="bg-gray-50">
          <td colspan="8" class="px-4 py-2 text-left border-t border-gray-200">
            <div>
              <strong>Extra Details:</strong><br>
              Denial Reason: <span class="denial_reason">{{ claim.denial_reason}}</span><br>
              CPT Codes: {{ claim.cpt_codes }}
            </div>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>